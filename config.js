﻿// ==========================================
// КОНФИГУРАЦИЯ ПРИЛОЖЕНИЯ
// API, промпты, дефолтные настройки
// Стабильная версия v1.0 + HINTS
// ==========================================

const CONFIG = {
    API: {
        KEY: atob("Z3NrX1NUelQyS1FFQko3MGNDb1hDSllaV0dkeWIzRlk5OHJHN2xvWXUxSmc1SnV0VFZOSzIyVHY="),
        URL: "https://api.groq.com/openai/v1/chat/completions",
        MODEL: "meta-llama/llama-4-maverick-17b-128e-instruct",
        TEMPERATURE: 0.7,
        MAX_TOKENS: 2048,
        MAX_RETRIES: 3
    },
    DEFAULTS: {
        AUDIENCE: "общая аудитория",
        DURATION: 30,
        STATUS: "draft"
    },
    STORAGE: {
        KEY: "theological_assistant_sermons",
        EXPORT_FILENAME_PREFIX: "sermons_backup_",
        AUTO_SAVE_INTERVAL: 30000  // 30 секунд
    },

    // -------------------------------------------------
    // ТИПЫ ПОМОЩИ
    // -------------------------------------------------
    ASSISTANCE_TYPES: {
        EXEGESIS: "exegesis",
        ILLUSTRATION: "illustration",
        STRUCTURE: "structure"
    },

    // -------------------------------------------------
    // ТИПЫ ПОДСКАЗОК (HINTS)
    // -------------------------------------------------
    HINT_TYPES: {
        INTRODUCTION: "introduction",
        APPLICATION: "application",
        ILLUSTRATION: "illustration",
        CONCLUSION: "conclusion"
    },

    // -------------------------------------------------
    // ПРОМПТЫ
    // -------------------------------------------------
    PROMPTS: {
        // Системный промпт – единый для всех запросов
        SYSTEM: "Ты — высококвалифицированный Теологический Ассистент и Коуч для проповедников. Твоя задача — помочь пользователю развить идеи, направленные Духом, и укрепить их теологическую основу. Отвечай уважительно, сосредоточенно на Библии и в коучинговом тоне. Всегда ссылайся на предоставленный пользователем отрывок и его личную идею. Форматируй ответ в Markdown для лучшей читаемости.",

        // ------------------- ОСНОВНЫЕ АНАЛИЗЫ -------------------
        EXEGESIS: (passage, draft) => `Проведи детальный экзегетический анализ отрывка '${passage}'. Включи исторический и культурный контекст, значение ключевых греческих/еврейских слов и их связь с моим тезисом: '${draft}'. В конце задай мне наводящий вопрос для личного размышления.`,

        ILLUSTRATION: (passage, draft, audience) => `Исходя из отрывка '${passage}' и моей основной мысли: '${draft}', предложи 3-4 концептуальных идеи для иллюстраций (метафоры, примеры из современной жизни или науки, но НЕ готовые истории), которые будут актуальны для аудитории '${audience}'. Объясни, как каждая идея отражает главную истину.`,

        STRUCTURE: (passage, draft, audience) => `Оцени мою основную мысль: '${draft}' в контексте '${passage}'. Является ли она библейски обоснованной? Предложи логический план проповеди (3-4 пункта), который ясно доведет эту мысль до аудитории '${audience}'. В конце дай совет по улучшению ясности или практического применения.`,

        // ------------------- ПОДСКАЗКИ (HINTS) -------------------

        /** Подсказки для введения */
        HINT_INTRODUCTION: (passage, draft, audience) => `
Ты — мудрый коуч-проповедник.  
На основе отрывка "${passage}" и главной идеи:

"${draft}"

Дай **3 короткие подсказки** (по 1 предложению) для начала проповеди.  
Каждая — это **зацепка**, которую я разовью сам.

Аудитория: "${audience}".

Формат:
### Подсказки для введения
1. **Вопрос:** [короткий вопрос]
2. **Образ:** [яркий образ или метафора]
3. **Ситуация:** [реальная жизненная ситуация]
`.trim(),

        /** Подсказки для применения */
        HINT_APPLICATION: (passage, draft, audience) => `
На основе отрывка "${passage}" и моей идеи:

"${draft}"

Предложи **3 конкретные подсказки** для практического применения.  
Каждая — это **одно действие или вопрос к слушателям**.

Аудитория: "${audience}".

Формат:
### Подсказки для применения
1. **Действие:** [что сделать на этой неделе]
2. **Вопрос:** [для размышления в группе]
3. **Вызов:** [шаг веры]
`.trim(),

        /** Подсказки для иллюстраций (дополняет основной ILLUSTRATION) */
        HINT_ILLUSTRATION: (passage, draft, audience) => `
Из отрывка "${passage}" и идеи "${draft}"  
выдели **3 концептуальные подсказки** для иллюстраций.

НЕ пиши готовые истории — только **идеи-семена**.

Аудитория: "${audience}".

Формат:
### Подсказки для иллюстраций
1. **Из природы:** [аналогия]
2. **Из жизни:** [ситуация]
3. **Из культуры:** [фильм, книга, событие]
`.trim(),

        /** Подсказки для заключения */
        HINT_CONCLUSION: (passage, draft, audience) => `
Финал проповеди на тему "${draft}" (отрывок: ${passage}).

Дай **3 подсказки** для мощного завершения:  
— призыв, образ или вопрос.

Аудитория: "${audience}".

Формат:
### Подсказки для заключения
1. **Призыв:** [короткий призыв к действию]
2. **Образ:** [финальный образ]
3. **Вопрос:** [оставить с мыслью]
`.trim()
    }
};

// Экспорт в глобальную область
if (typeof window !== 'undefined') {
    window.CONFIG = CONFIG;
}